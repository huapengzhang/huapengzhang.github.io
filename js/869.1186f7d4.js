"use strict";(self["webpackChunkharmony_transfer"]=self["webpackChunkharmony_transfer"]||[]).push([[869],{8869:function(e,a,l){l.r(a),l.d(a,{default:function(){return T}});var u=l(9424),n=(l(65083),l(64520)),t=(l(33110),l(27495),l(25440),l(58335),l(95976)),r=l(10160),v=l(29746),i=l(12040),o=l(39053),d=l(51449),s=l(95400),c=l(37868),g=l(86635),p=l(51884),h=l(53620),y={class:"remind-text"},S={class:"cell-phone"},m={class:"my-title-box"},k={class:"input-box"},b={class:"submitBtn"},I={__name:"AdvanceManagerUpload",setup(e){var a,l,I,{state:f}=(0,d.Pj)(),A=(0,t.EW)(()=>{var e;return null===(e=C.currentRoute.value.query)||void 0===e?void 0:e.homeSize}),T=(0,i.KR)(""),C=(0,o.rd)(),N=(0,i.KR)({}),_=(0,i.KR)(),R=(0,t.EW)(()=>{var e;return null===(e=_.value)||void 0===e||null===(e=e.MobilePhone)||void 0===e?void 0:e.replace(/(\d{3})\d{4}(\d{4})/,"$1****$2")}),L=(0,t.EW)(()=>{var e;return JSON.parse(null===(e=C.currentRoute.value)||void 0===e||null===(e=e.query)||void 0===e?void 0:e.advanceReqData)}),W=(0,t.EW)(()=>{var e;return JSON.parse(null===(e=C.currentRoute.value)||void 0===e||null===(e=e.query)||void 0===e?void 0:e.confirmResData)}),P=(0,t.EW)(()=>f.advanceTransfer.advanceManagerInfo),x=(0,i.KR)("");null!==(a=P.value)&&void 0!==a&&a.name&&(null===(l=P.value)||void 0===l?void 0:l.name.length)>0&&(x.value=(null===(I=P.value)||void 0===I?void 0:I.name)+"转账确认");h.log("pageInfo:",P.value);var E=!1;E="1"!=L.value.AuthType||(0,t.EW)(()=>{var e;return(null===(e=T.value)||void 0===e?void 0:e.length)>5});var O=(0,t.EW)(()=>W.value.UsedPin),K=(0,i.KR)("");K.value="Y"==O.value?"手机证书密码":"提交","3"!=L.value.AuthType&&"4"!=L.value.AuthType||(K.value="输入密码");var D=()=>{try{c.ui({OriTransCode:"MobileBookTrsMgmtConfirm"})}catch(e){h.log("err",e)}},M=()=>{T.value=""},V=()=>{"1"==L.value.AuthType?w():W.value.CertType&&"sf"==W.value.CertType?U():"3"!=L.value.AuthType&&"4"!=L.value.AuthType||J()},J=()=>{var e=L.value.submitTransId.replace(".do","");g.sendNativeInstrution("getBlueToothKeySignature",{TransactionId:e,Pargram:L.value,HashAlg:"2",DisplayFields:"PayerAcName,PayerAcNo,Amount"},e=>{var a=JSON.parse(e);"true"==a.SignatureState?(N.value={CSIISignature:a.CSIISignature},w()):"popView"==a.ErrMsg?C.go(-1):(0,n.A)(a.ErrMsg)})},U=()=>{var e="true";e=W.value.UsedPin&&"Y"==W.value.UsedPin?"true":"false";var a=JSON.parse(JSON.stringify(L.value));a.CSIISignature="",a.SignData="",a.SignValue="",g.sendNativeInstrution("getMobileCertSignature",{preSignData:a,needPwdKbd:e},e=>{var a=JSON.parse(e);"2"==a.type?(N.value={CSIISignature:a.CSIISignature,SignData:a.SignData,SignValue:a.SignValue},w()):"3"!=a.type&&"2"!=a.error||C.go(-1)})},w=()=>{try{c.G4({}).then(e=>{var a=(0,u.A)((0,u.A)({},N.value),L.value);a._tokenName=e._tokenName,""!=T.value&&(a.OTPPassword=T.value),s.y1(a).then(()=>{p.l.alert({message:P.value.name+"成功"}).then(()=>{try{C.go(-A.value)}catch(e){h.log(e),C.replace({path:"/TransferIndex"})}})})})}catch(e){h.log(e)}},B=(0,t.EW)(()=>F.value>=0?"重发（"+F.value+")":"重新获取"),F=(0,i.KR)(60),q=(0,i.KR)(!1),z=null;(0,t.sV)(()=>{G(),Y()});var G=()=>{var e,a=navigator.userAgent.indexOf("Qzccbank")>-1;a?g.sendNativeInstrution("getUserAllData",{},e=>{var a=JSON.parse(e);if("true"==(null===a||void 0===a?void 0:a.NetBankLoginStatus)){var l=null===a||void 0===a?void 0:a.netBankLoginInfo;_.value=l}}):_.value=null===(e=f.user)||void 0===e?void 0:e.pwebUser},Y=()=>{q.value||(q.value=!0,z=setInterval(()=>{F.value>=0?F.value--:(clearInterval(z),q.value=!1)},1e3))},$=()=>{q.value||(D(),F.value=60,Y())};return(0,t.xo)(()=>{q.value&&clearInterval(z)}),(e,a)=>{var l=(0,t.g2)("van-icon"),u=(0,t.g2)("van-field"),n=(0,t.g2)("van-cell"),o=(0,t.g2)("van-button"),d=(0,t.g2)("content-box");return(0,t.uX)(),(0,t.Wv)(d,{class:"container",title:x.value},{default:(0,t.k6)(()=>[(0,t.bo)((0,t.Lk)("div",null,[(0,t.Lk)("div",y,[a[1]||(a[1]=(0,t.eW)(" 已向手机号",-1)),(0,t.Lk)("span",S,(0,r.v_)(R.value),1),a[2]||(a[2]=(0,t.eW)("的手机发送短信验证短信 ",-1))]),(0,t.bF)(n,{class:"my-cell"},{title:(0,t.k6)(()=>[(0,t.Lk)("div",null,[(0,t.Lk)("div",m,[a[3]||(a[3]=(0,t.Lk)("div",{class:"title"},"短信验证码",-1)),(0,t.Lk)("div",k,[(0,t.bF)(u,{modelValue:T.value,"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),placeholder:"请输入短信验证码",type:"digit",maxlength:"6"},{"right-icon":(0,t.k6)(()=>{var e;return[(0,t.bF)(l,{name:"close",onClick:M,class:(0,r.C4)({hidden:(null===(e=T.value)||void 0===e?void 0:e.length)<=0})},null,8,["class"])]}),_:1},8,["modelValue"])])])])]),extra:(0,t.k6)(()=>[(0,t.Lk)("div",null,[(0,t.Lk)("div",{class:"unit-text cell-phone",onClick:$},(0,r.v_)(B.value),1)])]),_:1})],512),[[v.aG,"1"==L.value.AuthType||"4"==L.value.AuthType]]),(0,t.Lk)("div",b,[(0,t.bF)(o,{type:"primary","native-type":"submit",disabled:!(0,i.R1)(E),onClick:V},{default:(0,t.k6)(()=>[(0,t.eW)((0,r.v_)(K.value),1)]),_:1},8,["disabled"])])]),_:1},8,["title"])}}},f=l(1169);const A=(0,f.A)(I,[["__scopeId","data-v-d6b04074"]]);var T=A}}]);