"use strict";(self["webpackChunkharmony_transfer"]=self["webpackChunkharmony_transfer"]||[]).push([[35],{5946:function(e,a,t){t.d(a,{Q8:function(){return l},Us:function(){return r},it:function(){return u}});var n=t(66508);function l(e){return(0,n.A)({url:"pweb/MobileTransferCancelQry.do",method:"POST",data:e})}function r(e){return(0,n.A)({url:"pweb/TransferCancelConfirm.do",method:"POST",data:e})}function u(e){return(0,n.A)({url:"pweb/TransferCancel.do",method:"POST",data:e})}},27035:function(e,a,t){t.r(a),t.d(a,{default:function(){return b}});var n=t(9424),l=(t(65083),t(64520)),r=(t(27495),t(25440),t(44114),t(33110),t(58335),t(95976)),u=t(10160),s=t(12040),v=t(86635),i=t(39053),o=t(51449),c=t(5946),d=t(34568),p=t(53620),f={class:"infowrap"},m={class:"text_center padding_10"},g={class:"amount_size"},y={class:"padding_10"},k={class:"padding_10"},S={__name:"CancelDetail",setup(e){var{state:a,commit:S}=(0,o.Pj)(),h=(0,s.KR)(""),T=(0,s.KR)(!1),b=(0,i.rd)(),_=(0,r.EW)(()=>b.currentRoute.value.query),C=(0,s.KR)(""),N=(0,s.KR)(""),P=(0,s.KR)(""),A=(0,s.KR)([]),I=(0,s.KR)(""),R=(0,s.KR)({}),w=()=>{A.value=[];var e=[];"0"==C.value&&"0"==N.value&&e.push({type:"sf",title:"手机证书"}),"1"!=h.value&&"7"!=h.value||e.push({type:"1",title:"手机短信"}),"true"!=P.value||"3"!=h.value&&"7"!=h.value||e.push({type:"3",title:"蓝牙UKey"}),"true"==P.value&&"4"==h.value&&e.push({type:"4",title:"手机短信+蓝牙Ukey"}),0!=e.length?(A.value=e,T.value=!0):(0,l.A)("暂无其它认证方式可选择")},F=e=>{T.value=!1,R.value={},R.value.SeqNo=_.value.SeqNo,R.value.ChannelJnlNo=_.value.ChannelJnlNo,R.value.PayerAcNo=_.value.PayerAcNo,R.value.PayerName=_.value.PayerName,R.value.Amount=_.value.Amount,R.value.PayeeAcNo=_.value.PayeeAcNo,R.value.PayeeName=_.value.PayeeName,R.value.TrsDate=_.value.TrsDate,R.value.Format=_.value.Format,R.value.TransactionId="TransferCancelConfirm","sf"==e?(R.value.CertType="sf",R.value.OriTransCode="TransferCancelConfirm"):R.value.AuthType=e,S("cancelTransfer/setState",{key:"cancelRequest",value:R.value}),c.Us(R.value).then(a=>{var t=a;S("cancelTransfer/setState",{key:"responseData",value:t}),"1"==e||"4"==e?b.push({path:"/TransferCancelVerify",query:(0,n.A)((0,n.A)({},_.value),{},{AuthType:e,mobilePhone:I.value})}):K(e)})},L=()=>{var e=navigator.userAgent.indexOf("Qzccbank")>-1,t={};e?v.sendNativeInstrution("getUserAllData",{},e=>{t=JSON.parse(e),q(t)}):(t=a.user.pwebUser,q(t))},q=e=>{var a,t,n;h.value=null===e||void 0===e||null===(a=e.netBankLoginInfo)||void 0===a?void 0:a.AuthType,"1"==h.value&&(h.value="1"),"3"==h.value&&"1"==P.value&&(h.value="3"),"4"==h.value&&"1"==P.value&&(h.value="4"),N.value=e.CertState,C.value=e.SoftCertFlag,P.value=String(null===(t=e.netBankLoginInfo)||void 0===t?void 0:t.isBlueUkey),I.value=null===e||void 0===e||null===(n=e.netBankLoginInfo)||void 0===n?void 0:n.MobilePhone},K=e=>{"sf"==e?D():"3"==e&&U()},D=()=>{var e="true";a.cancelTransfer.responseData.UsedPin&&"Y"==a.cancelTransfer.responseData.UsedPin?p.log("UsedPin==yes"):e="false";var t=JSON.parse(JSON.stringify(a.cancelTransfer.cancelRequest));t.CSIISignature="",t.SignData="",t.SignValue="",v.sendNativeInstrution("getMobileCertSignature",{preSignData:a.cancelTransfer.cancelRequest,needPwdKbd:e},e=>{var a=JSON.parse(e);if("2"==a.type){var t={};t.CSIISignature=a.CSIISignature,t.SignData=a.SignData,t.SignValue=a.SignValue,S("cancelTransfer/setState",{key:"cancelRequest",value:t}),B()}})},U=()=>{v.sendNativeInstrution("getBlueToothKeySignature",{TransactionId:"TransferCancel",Pargram:a.cancelTransfer.cancelRequest,HashAlg:"1",type:"caremodel"},e=>{var a=JSON.parse(e);if("true"==a.SignatureState){var t={};t.CSIISignature=a.CSIISignature,S("cancelTransfer/setState",{key:"cancelRequest",value:t}),B()}else(0,l.A)(a.ErrMsg)})},B=()=>{d.GenToken().then(e=>{var t=e._tokenName;v.sendNativeInstrution("callPwdKbd",{},e=>{var n=JSON.parse(e);if((null===n||void 0===n||!n.cancelInput||"true"!=(null===n||void 0===n?void 0:n.cancelInput))&&n.pwd&&n.pwdLength&&6==n.pwdLength){var r={_tokenName:t,TrsPassword:n.pwd};S("cancelTransfer/setState",{key:"cancelRequest",value:r}),c.it(a.cancelTransfer.cancelRequest).then(()=>{(0,l.A)("撤销成功"),S("cancelTransfer/resetRequest"),b.replace("/TransferRecord")})}})})};return(0,r.sV)(()=>{L()}),(e,a)=>{var n=(0,r.g2)("van-cell"),l=(0,r.g2)("van-cell-group"),v=(0,r.g2)("van-image"),i=(0,r.g2)("van-button"),o=(0,r.g2)("van-popup"),c=(0,r.g2)("content-box");return(0,r.uX)(),(0,r.Wv)(c,{class:"container",title:"转出详情"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",f,[(0,r.bF)(l,{class:"_marginBottom10 content"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",m,[(0,r.Lk)("div",g,"-"+(0,u.v_)(_.value.Amount),1),a[2]||(a[2]=(0,r.Lk)("div",{class:"amount_remark"},"转账金额（元）",-1))]),(0,r.bF)(n,{title:"收款人",class:"van-hairline--bottom van-hairline--top UncommonShow",value:_.value.PayeeName||_.value.PayeeAcName},null,8,["value"]),(0,r.bF)(n,{title:"账户",class:"van-hairline--bottom",value:_.value.PayeeAcNo},null,8,["value"]),(0,r.bF)(n,{title:"银行",class:"van-hairline--bottom",value:_.value.PayeeBankName},null,8,["value"]),(0,r.bF)(n,{title:"交易时间",value:_.value.TrsDate},null,8,["value"])]),_:1}),(0,r.bF)(l,{class:"_marginBottom10 content"},{default:(0,r.k6)(()=>[(0,r.bF)(n,{title:"转出账户",class:"van-hairline--bottom"},{value:(0,r.k6)(()=>[(0,r.eW)(" 泉州银行 尾号("+(0,u.v_)(_.value.PayerAcNo.slice(-4))+") ",1)]),extra:(0,r.k6)(()=>[(0,r.bF)(v,{width:"40",fit:"contain",src:t(80014)},null,8,["src"])]),_:1}),(0,r.bF)(n,{title:"转账时间",value:_.value.TrsferTypeName},null,8,["value"]),(0,r.bF)(n,{title:"附言",value:_.value.Remark},null,8,["value"])]),_:1}),(0,r.Lk)("div",y,[(0,r.bF)(i,{type:"primary",plain:"",block:"",text:"撤销转账",onClick:a[0]||(a[0]=e=>w())})]),(0,r.bF)(o,{show:T.value,"onUpdate:show":a[1]||(a[1]=e=>T.value=e),position:"bottom"},{default:(0,r.k6)(()=>[(0,r.Lk)("div",k,[a[3]||(a[3]=(0,r.Lk)("p",{class:"text_center _marginBottom10 vertify_title"}," 需先进行认证验证 ",-1)),a[4]||(a[4]=(0,r.Lk)("p",{class:"text_center _marginBottom10 vertify_label"}," 请选择认证方式 ",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,s.R1)(A),(e,a)=>((0,r.uX)(),(0,r.CE)("div",{key:a},[(0,r.bF)(i,{type:"primary",class:"_marginBottom10",plain:"",block:"",text:e.title,onClick:a=>F(e.type)},null,8,["text","onClick"])]))),128))])]),_:1},8,["show"])])]),_:1})}}},h=t(1169);const T=(0,h.A)(S,[["__scopeId","data-v-0e2058b9"]]);var b=T},80014:function(e,a,t){e.exports=t.p+"img/icon_ylList.38a06f95.png"}}]);